<!DOCTYPE html>
<html>
  <head>
    <style>body { background-color: black }</style>
  </head>
  <body>
    <div id="canvases"></div>
    <script>
      var minInd = 141;
      var maxInd = 151;//151;
      for(var i = minInd; i <= maxInd; i++) {
        var image = new Image();
        image.onload = function() {
          document.body.appendChild(this);
          var height = this.height;
          var width = this.width;
          var canvas = document.createElement('canvas');
          document.getElementById('canvases').appendChild(canvas);
          canvas.height = 300;
          canvas.width = 300;
          var context = canvas.getContext('2d');
          var leastDim = Math.min(width, height);
          if(width < height) {
            height = 300 / width * height;
            width = 300;
            startX = 0;
            startY = (300 - height) / 2;
          } else {
            width = 300 / height * width;
            height = 300;
            startX = (300 - width) / 2;
            startY = 0;
          }
          context.translate(startX, startY);
          context.drawImage(this,0,0,width,height);
          document.body.removeChild(this);
          var imgData = canvas.toDataURL();
          canvas.parentElement.removeChild(canvas);
          var a = document.createElement('a');
          a.href = imgData;
          a.download = this.src.match(/photo_[0-9]+/)[0] + '.png';
          a.dispatchEvent(new MouseEvent('click'));
        }
        image.src = "photos/photo_" + i + ".jpg";
      }
    </script>
  </body>
</html>
